import re

file_in = 'EWRA_FOOTPRINT_2026_JANUARY.csv'
file_out = 'CLEAN_BUSINESS_TYPES.csv'

with open(file_in, 'r') as f:
    lines = f.readlines()

with open(file_out, 'w') as f:
    # Adding header for Excel alignment
    f.write("RFNON_BUS_TYPE,ENTITYNAME\n")
    for line in lines[1:]: # Skip the original messy header
        # This matches the single letter code followed by the rest of the name
        match = re.match(r'^([A-Z])\s+(.*)', line.strip())
        if match:
            code, name = match.groups()
            f.write(f'{code},"{name}"\n')

print("Process finished. Check CLEAN_BUSINESS_TYPES.csv now.")
