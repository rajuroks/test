import re

file_in = 'EWRA_FOOTPRINT_2026_JANUARY.csv'
file_out = 'CLEAN_BUSINESS_TYPES.csv'

with open(file_in, 'r') as f:
    lines = f.readlines()

with open(file_out, 'w') as f:
    f.write("RFNON_BUS_TYPE,ENTITYNAME\n")
    for line in lines:
        # This split handles both tabs and multiple spaces
        parts = re.split(r'\s{2,}', line.strip())
        if len(parts) >= 2:
            code = parts[0].strip()
            name = parts[1].strip()
            # Only write if the code is a single letter (A, C, E, etc.)
            if len(code) == 1 and code.isalpha():
                f.write(f'{code},"{name}"\n')

print("Process finished. Open CLEAN_BUSINESS_TYPES.csv to verify.")
