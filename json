import re

file_in = 'EWRA_FOOTPRINT_2026_JANUARY.csv'
file_out = 'CLEAN_BUSINESS_TYPES.csv'

with open(file_in, 'r') as f:
    lines = f.readlines()

with open(file_out, 'w') as f:
    f.write("RFNON_BUS_TYPE,ENTITYNAME\n")
    for line in lines:
        text = line.strip()
        # Look for a single letter at the start, followed by any whitespace
        match = re.match(r'^([A-Z])\s+(.*)', text)
        if match:
            code, name = match.groups()
            # Clean up extra spaces from the name and write to file
            f.write(f'{code},"{name.strip()}"\n')

print("Process finished. Check the file now!")
